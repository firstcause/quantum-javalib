<?xml version="1.0"?>

<MutinyApp
		name="mutiny_test"
		action="mutinyAction('switch:/entry_point_switch');">

	Here is the text

	<LinkSpec filespec="patrol_mode.xml" />
	<!-- <LinkSpec filespec="train_mode.xml" /> -->

	<TokenSwitchDef name='entry_point_switch' token="mutinyState('query:state_token:config_state');">

		<TokenCaseDef token="factory_reset">

			<ActionDef action="mutinyRequest('app_install');"/>

			<ActionDef action="mutinyRequest('show_welcome_page');"/>

			<ActionDef action="mutinyState('persist:config_state:legal_acknowledgements');"/>

			<ActionDef action="mutinyRequest('restart_activity');"/>

		</TokenCaseDef>

		<TokenCaseDef token="legal_acknowlegements">

			<ActionDef action="mutinyRequest('show_legal_page');"/>

			<ActionDef action="mutinyState('persist:config_state:app_ready');"/>

		</TokenCaseDef>

		<TokenCaseDef token="app_ready">

			<ActionDef action="mutinySwitch('/user_login_switch');"/>

		</TokenCaseDef>

	</TokenSwitchDef>

	<TokenSwitchDef name='user_login_switch' token="mutinyState('query:session:login_state');">

		<TokenCaseDef token="not_found">

			<ActionDef action="mutinyRequest('do_user_login');"/>

		</TokenCaseDef>

		<TokenCaseDef token="user_ready">

			<ActionDef action="mutinyAction('switch/user_config_switch');"/>

		</TokenCaseDef>

	</TokenSwitchDef>

	<TokenSwitchDef name='user_config_switch' token="mutinyState('query:state_token:user_config')">

		<TokenCaseDef token="not_found">

			<ActionDef action="mutinyRequest('do_user_config');"/>

		</TokenCaseDef>

		<TokenCaseDef token="user_config_ready">

			<ActionDef action="mutinyAction('show_menu:/user_ready_main'"/>

		</TokenCaseDef>

	</TokenSwitchDef>

	<MenuDef name="user_ready_main">

		<MenuItem onclick="mutinyAction('show_menu_on_stack:/training/main_menu');">
			trainer_mode_menu_prompt
		</MenuItem>

		<MenuItem onclick="mutinyAction('show_menu_on_stack:/patrol/main_menu');">
			patrol_mode_main_prompt
		</MenuItem>

	</MenuDef>

</MutinyApp>
